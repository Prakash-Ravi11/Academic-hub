<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlowState Pro - Ultimate AI Productivity Companion</title>
    <meta name="description" content="Ultimate AI productivity companion with real ChatGPT, cloud storage, voice AI, and intelligent task management">
    <meta name="theme-color" content="#3b82f6">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- External CDNs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* ============ RESTORED ORIGINAL STYLING ============ */
        :root {
            /* Light Theme - Apple-Inspired */
            --bg-primary: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            --bg-secondary: rgba(255, 255, 255, 0.95);
            --bg-tertiary: rgba(248, 250, 252, 0.9);
            --text-primary: #1a202c;
            --text-secondary: #64748b;
            --text-accent: #3b82f6;
            --border-color: rgba(0, 0, 0, 0.08);
            --shadow-primary: 0 10px 25px rgba(0, 0, 0, 0.08);
            --shadow-secondary: 0 4px 12px rgba(0, 0, 0, 0.04);
            --primary-color: #3b82f6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --card-bg: rgba(255, 255, 255, 0.9);
            --accent-gradient: linear-gradient(135deg, #3b82f6, #1d4ed8);
            --glass-bg: rgba(255, 255, 255, 0.7);
        }

        [data-theme="dark"] {
            --bg-primary: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            --bg-secondary: rgba(15, 23, 42, 0.95);
            --bg-tertiary: rgba(30, 41, 59, 0.9);
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-accent: #60a5fa;
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow-primary: 0 25px 50px rgba(0, 0, 0, 0.4);
            --shadow-secondary: 0 8px 25px rgba(0, 0, 0, 0.2);
            --primary-color: #60a5fa;
            --success-color: #34d399;
            --warning-color: #fbbf24;
            --danger-color: #f87171;
            --card-bg: rgba(15, 23, 42, 0.95);
            --accent-gradient: linear-gradient(135deg, #60a5fa, #3730a3);
            --glass-bg: rgba(15, 23, 42, 0.7);
        }

        [data-theme="elegant"] {
            --bg-primary: linear-gradient(135deg, #fdf4ff 0%, #f3e8ff 100%);
            --bg-secondary: rgba(253, 244, 255, 0.95);
            --bg-tertiary: rgba(243, 232, 255, 0.9);
            --text-primary: #581c87;
            --text-secondary: #7c3aed;
            --text-accent: #a855f7;
            --border-color: rgba(139, 92, 246, 0.15);
            --shadow-primary: 0 20px 40px rgba(139, 92, 246, 0.15);
            --shadow-secondary: 0 8px 20px rgba(139, 92, 246, 0.08);
            --primary-color: #8b5cf6;
            --success-color: #06d6a0;
            --warning-color: #ffd60a;
            --danger-color: #ff006e;
            --card-bg: rgba(253, 244, 255, 0.9);
            --accent-gradient: linear-gradient(135deg, #8b5cf6, #7c3aed);
            --glass-bg: rgba(253, 244, 255, 0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Inter', sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-primary);
            line-height: 1.6;
            font-weight: 400;
            overflow-x: hidden;
        }

        /* ============ Authentication Modal ============ */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 4000;
            animation: fadeIn 0.3s ease;
        }

        .auth-modal.hidden {
            display: none;
        }

        .auth-content {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            padding: 48px;
            box-shadow: var(--shadow-primary);
            max-width: 480px;
            width: 90%;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .auth-logo {
            width: 80px;
            height: 80px;
            background: var(--accent-gradient);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 36px;
            font-weight: 700;
            margin: 0 auto 32px;
            box-shadow: 0 12px 40px rgba(0, 122, 255, 0.3);
        }

        .auth-title {
            font-size: 32px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
            letter-spacing: -0.02em;
        }

        .auth-subtitle {
            color: var(--text-secondary);
            margin-bottom: 40px;
            font-size: 18px;
            font-weight: 500;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .auth-input {
            padding: 18px 20px;
            border: 1px solid var(--border-color);
            border-radius: 16px;
            font-size: 17px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .auth-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.1);
            transform: translateY(-2px);
        }

        .auth-btn {
            padding: 18px 32px;
            background: var(--accent-gradient);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 24px rgba(0, 122, 255, 0.3);
        }

        .auth-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 32px rgba(0, 122, 255, 0.4);
        }

        .auth-switch {
            margin-top: 32px;
            color: var(--text-secondary);
            font-size: 16px;
        }

        .auth-link {
            color: var(--primary-color);
            cursor: pointer;
            font-weight: 600;
            text-decoration: none;
        }

        /* ============ Main App Container ============ */
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            border-radius: 28px;
            padding: 40px;
            box-shadow: var(--shadow-primary);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .app-title {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .app-logo {
            width: 56px;
            height: 56px;
            background: var(--accent-gradient);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: 700;
            box-shadow: 0 8px 24px rgba(0, 122, 255, 0.3);
        }

        .app-name {
            font-size: 36px;
            font-weight: 800;
            color: var(--text-primary);
            letter-spacing: -0.02em;
        }

        .app-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            margin-left: 4px;
            font-weight: 500;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        /* ============ Theme Selector ============ */
        .theme-selector {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 6px;
            background: var(--bg-tertiary);
            border-radius: 16px;
            border: 1px solid var(--border-color);
        }

        .theme-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .theme-btn:hover {
            background: var(--border-color);
            color: var(--text-primary);
            transform: scale(1.05);
        }

        .theme-btn.active {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 16px rgba(0, 122, 255, 0.3);
        }

        /* ============ User Profile ============ */
        .user-profile {
            position: relative;
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px 20px;
            background: var(--bg-tertiary);
            border-radius: 16px;
            cursor: pointer;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .user-profile:hover {
            background: var(--card-bg);
            transform: translateY(-2px);
            box-shadow: var(--shadow-secondary);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: var(--accent-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 16px;
        }

        .user-name {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 16px;
        }

        /* ============ Main Content Layout ============ */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 40px;
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-secondary);
            transition: all 0.3s ease;
            margin-bottom: 24px;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-primary);
        }

        .card-header {
            margin-bottom: 28px;
        }

        .card-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            letter-spacing: -0.01em;
        }

        .card-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* ============ Form Elements ============ */
        .input-group {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .input-field {
            padding: 16px 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            font-size: 17px;
            background: var(--bg-secondary);
            transition: all 0.3s ease;
            font-family: inherit;
            color: var(--text-primary);
            flex: 1;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.1);
            background: var(--bg-secondary);
            transform: translateY(-2px);
        }

        /* ============ Button Styles ============ */
        .btn {
            padding: 16px 28px;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: inherit;
            text-align: center;
            justify-content: center;
        }

        .btn-primary {
            background: var(--accent-gradient);
            color: white;
            box-shadow: 0 6px 20px rgba(0, 122, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 32px rgba(0, 122, 255, 0.4);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
            transform: translateY(-2px);
        }

        .btn-small {
            padding: 12px 20px;
            font-size: 15px;
        }

        /* ============ Enhanced Quote Display ============ */
        .quote-display {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 32px;
            margin: 24px 0;
            border-left: 6px solid var(--primary-color);
            border: 1px solid var(--border-color);
            position: relative;
            box-shadow: var(--shadow-secondary);
        }

        .quote-text {
            font-style: italic;
            font-size: 20px;
            color: var(--text-primary);
            margin-bottom: 16px;
            line-height: 1.6;
            font-weight: 400;
        }

        .quote-author {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 16px;
        }

        .quote-category {
            position: absolute;
            top: 16px;
            right: 20px;
            background: var(--primary-color);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* ============ Voice Panel ============ */
        .voice-panel {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-secondary);
        }

        .voice-controls {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .voice-btn {
            width: 64px;
            height: 64px;
            border: none;
            border-radius: 50%;
            background: var(--accent-gradient);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 8px 24px rgba(0, 122, 255, 0.3);
        }

        .voice-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 32px rgba(0, 122, 255, 0.4);
        }

        .voice-btn.listening {
            background: var(--danger-color);
            animation: pulse 2s infinite;
        }

        /* ============ Chat Interface ============ */
        .chat-messages {
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: 16px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
        }

        .message {
            margin-bottom: 16px;
            padding: 16px 20px;
            border-radius: 18px;
            max-width: 85%;
            word-wrap: break-word;
        }

        .message.user {
            background: var(--accent-gradient);
            color: white;
            margin-left: auto;
            text-align: right;
            box-shadow: 0 4px 16px rgba(0, 122, 255, 0.3);
        }

        .message.ai {
            background: var(--card-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            margin-right: auto;
            box-shadow: var(--shadow-secondary);
        }

        /* ============ Progress Ring ============ */
        .progress-ring-container {
            text-align: center;
            padding: 20px;
        }

        .progress-ring {
            width: 140px;
            height: 140px;
            margin: 20px auto;
            position: relative;
        }

        .progress-ring svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .progress-ring circle {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
        }

        .progress-ring .background {
            stroke: var(--border-color);
        }

        .progress-ring .progress {
            stroke: var(--primary-color);
            stroke-dasharray: 377;
            stroke-dashoffset: 377;
            transition: stroke-dashoffset 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .progress-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .progress-percent {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .progress-label {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        /* ============ Task Styles ============ */
        .task-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: 16px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .task-item:hover {
            background: var(--card-bg);
            transform: translateX(8px);
            box-shadow: var(--shadow-secondary);
        }

        .task-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .task-checkbox.checked {
            background: var(--primary-color);
            color: white;
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .task-meta {
            font-size: 14px;
            color: var(--text-secondary);
            display: flex;
            gap: 12px;
        }

        /* ============ Statistics Grid ============ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-secondary);
        }

        .stat-number {
            font-size: 32px;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        /* ============ Notification System ============ */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 400px;
        }

        .notification {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px 20px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-secondary);
            backdrop-filter: blur(20px);
            animation: slideIn 0.3s ease;
        }

        .notification.success {
            border-left: 4px solid var(--success-color);
        }

        .notification.error {
            border-left: 4px solid var(--danger-color);
        }

        /* ============ Loading & Animations ============ */
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ============ Responsive Design ============ */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 20px;
                border-radius: 20px;
                margin: 10px;
            }
            
            .header-controls {
                flex-direction: column;
                gap: 16px;
            }

            .voice-controls {
                justify-content: center;
            }

            .input-group {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ============ Utility Classes ============ */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .mt-4 { margin-top: 16px; }
        .mb-4 { margin-bottom: 16px; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-4 { gap: 16px; }
    </style>
</head>
<body data-theme="light">
    <!-- Authentication Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-content">
            <div class="auth-logo">FS</div>
            <div class="auth-title" id="authTitle">Welcome to FlowState Pro</div>
            <div class="auth-subtitle" id="authSubtitle">Sign in to your account</div>
            
            <form class="auth-form" id="authForm">
                <input type="text" class="auth-input" id="nameInput" placeholder="Full Name" style="display: none;">
                <input type="email" class="auth-input" id="emailInput" placeholder="Email Address" required>
                <input type="password" class="auth-input" id="passwordInput" placeholder="Password" required>
                
                <button type="submit" class="auth-btn" id="authSubmitBtn">
                    <span id="authButtonText">Sign In</span>
                    <div id="authLoader" class="spinner hidden"></div>
                </button>
            </form>
            
            <div class="auth-switch">
                <span id="authSwitchText">Don't have an account?</span>
                <span class="auth-link" id="authSwitchLink">Create Account</span>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div class="app-container hidden" id="mainApp">
        <!-- Header -->
        <div class="app-header">
            <div class="app-title">
                <div class="app-logo">FS</div>
                <div>
                    <div class="app-name">FlowState Pro</div>
                    <div class="app-subtitle">Ultimate AI Productivity Companion</div>
                </div>
            </div>
            <div class="header-controls">
                <div class="theme-selector">
                    <button class="theme-btn active" onclick="setTheme('light')">Light</button>
                    <button class="theme-btn" onclick="setTheme('dark')">Dark</button>
                    <button class="theme-btn" onclick="setTheme('elegant')">Elegant</button>
                </div>
                
                <div class="user-profile" onclick="toggleUserMenu()">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-name" id="userName">User</div>
                </div>
            </div>
        </div>

        <!-- Voice Panel -->
        <div class="voice-panel">
            <div class="card-title">üé§ Voice AI Assistant</div>
            <div class="card-subtitle">Talk naturally with your AI productivity coach</div>
            
            <div class="voice-controls">
                <button class="voice-btn" id="voiceBtn" onclick="toggleVoice()">üé§</button>
                
                <div>
                    <select id="voiceGender" onchange="updateVoice()">
                        <option value="female">Female Voice</option>
                        <option value="male">Male Voice</option>
                    </select>
                </div>
                
                <div id="voiceStatus">Voice AI ready - Click microphone to start</div>
            </div>
        </div>

        <!-- Dynamic Quote Display -->
        <div class="quote-display" id="quoteDisplay">
            <div class="quote-category" id="quoteCategory">Motivation</div>
            <div class="quote-text" id="quoteText">
                "The way to get started is to quit talking and begin doing."
            </div>
            <div class="quote-author" id="quoteAuthor">‚Äî Walt Disney</div>
        </div>

        <!-- Main Content Grid -->
        <div class="main-content">
            <!-- Left Panel -->
            <div class="left-panel">
                <!-- Real ChatGPT Integration -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">ü§ñ Real ChatGPT Assistant</div>
                        <div class="card-subtitle">Powered by OpenRouter - Ask anything!</div>
                    </div>
                    
                    <div class="chat-messages" id="chatMessages">
                        <div class="message ai">
                            <strong>ü§ñ ChatGPT:</strong> Hello! I'm your real AI assistant powered by ChatGPT. I can help you with studying, productivity, coding, writing, and much more. What would you like to know?
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <textarea class="input-field" id="chatInput" placeholder="Ask ChatGPT anything..." rows="3"></textarea>
                        <button class="btn btn-primary" onclick="sendChatMessage()">
                            üöÄ Send
                        </button>
                        <button class="btn btn-secondary" onclick="startVoiceChat()">üé§ Voice</button>
                    </div>
                </div>

                <!-- Enhanced Task Creator -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üéØ Smart Task Creator</div>
                        <div class="card-subtitle">AI-powered task creation with voice support</div>
                    </div>
                    
                    <div class="input-group">
                        <input type="text" class="input-field" id="taskInput" placeholder="Describe your task...">
                        <button class="btn btn-primary" onclick="createTask()">ü§ñ Create</button>
                        <button class="btn btn-secondary" onclick="startVoiceTask()">üé§ Voice</button>
                    </div>
                </div>
            </div>

            <!-- Right Panel -->
            <div class="right-panel">
                <!-- Today's Tasks -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üìã Today's Mission</div>
                        <div class="card-subtitle" id="tasksSummary">Ready to conquer your goals</div>
                    </div>
                    
                    <div id="tasksList">
                        <div class="text-center" style="padding: 40px; color: var(--text-secondary);">
                            <div style="font-size: 48px; margin-bottom: 16px;">üéØ</div>
                            <div>Your productivity journey starts here!</div>
                            <div>Create your first task above</div>
                        </div>
                    </div>
                </div>

                <!-- Progress Ring -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üèÜ Daily Achievement</div>
                        <div class="card-subtitle">Your progress matters</div>
                    </div>
                    
                    <div class="progress-ring-container">
                        <div class="progress-ring">
                            <svg>
                                <circle class="background" cx="70" cy="70" r="60"></circle>
                                <circle class="progress" cx="70" cy="70" r="60" id="progressCircle"></circle>
                            </svg>
                            <div class="progress-center">
                                <div class="progress-percent" id="progressPercent">0%</div>
                                <div class="progress-label">Complete</div>
                            </div>
                        </div>
                        
                        <div id="dailyMessage" style="font-size: 18px; font-weight: 600; margin: 16px 0;">Ready to achieve greatness!</div>
                        <button class="btn btn-secondary btn-small" onclick="getMotivation()">üöÄ Motivate Me</button>
                    </div>
                </div>

                <!-- Analytics Dashboard -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üìä Analytics</div>
                        <div class="card-subtitle">Your productivity insights</div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalTasks">0</div>
                            <div class="stat-label">Total Tasks</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="completedTasks">0</div>
                            <div class="stat-label">Completed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="completionRate">0%</div>
                            <div class="stat-label">Success Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="streakCount">0</div>
                            <div class="stat-label">Day Streak</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <script>
        // ============ RESTORED & ENHANCED JAVASCRIPT ============
        
        // Application State
        let currentUser = null;
        let tasks = [];
        let completedTasks = [];
        let isLoggedIn = false;
        let recognition = null;
        let selectedVoice = null;
        let voices = [];
        let chatHistory = [];

        // Configuration (You'll replace with your secrets)
        const OPENROUTER_API_KEY = 'your-openrouter-api-key'; // Replace with your key
        const FIREBASE_CONFIG = {
            // Your Firebase config here
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            initializeVoice();
            initializeAuth();
            loadQuote();
            
            // If user was logged in, show main app
            const savedUser = localStorage.getItem('flowstate-user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainApp();
                loadUserData();
            }
        });

        // ============ Authentication System ============
        function initializeAuth() {
            document.getElementById('authForm').addEventListener('submit', handleAuth);
            document.getElementById('authSwitchLink').addEventListener('click', toggleAuthMode);
        }

        function handleAuth(event) {
            event.preventDefault();
            
            const email = document.getElementById('emailInput').value.trim();
            const password = document.getElementById('passwordInput').value.trim();
            const name = document.getElementById('nameInput').value.trim();
            const isSignUp = document.getElementById('authTitle').textContent.includes('Create');

            if (!email || !password || (isSignUp && !name)) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            // Show loading
            showAuthLoader(true);

            // Simulate auth process
            setTimeout(() => {
                if (isSignUp) {
                    // Create new user
                    const user = {
                        id: Date.now(),
                        name: name,
                        email: email,
                        password: btoa(password), // Simple encoding
                        createdAt: new Date()
                    };
                    
                    localStorage.setItem('flowstate-user', JSON.stringify(user));
                    currentUser = user;
                    showNotification(`Welcome ${name}! Account created successfully.`, 'success');
                } else {
                    // Simulate login
                    const savedUser = localStorage.getItem('flowstate-user');
                    if (savedUser) {
                        currentUser = JSON.parse(savedUser);
                        showNotification(`Welcome back ${currentUser.name}!`, 'success');
                    } else {
                        showNotification('No account found. Please create an account first.', 'error');
                        showAuthLoader(false);
                        return;
                    }
                }

                showMainApp();
                loadUserData();
                showAuthLoader(false);
            }, 1500);
        }

        function toggleAuthMode() {
            const title = document.getElementById('authTitle');
            const nameInput = document.getElementById('nameInput');
            const buttonText = document.getElementById('authButtonText');
            const switchText = document.getElementById('authSwitchText');
            const switchLink = document.getElementById('authSwitchLink');

            const isSignUp = title.textContent.includes('Create');

            if (isSignUp) {
                // Switch to login
                title.textContent = 'Welcome Back';
                nameInput.style.display = 'none';
                buttonText.textContent = 'Sign In';
                switchText.textContent = "Don't have an account?";
                switchLink.textContent = 'Create Account';
            } else {
                // Switch to signup
                title.textContent = 'Create Account';
                nameInput.style.display = 'block';
                buttonText.textContent = 'Create Account';
                switchText.textContent = 'Already have an account?';
                switchLink.textContent = 'Sign In';
            }

            // Clear form
            document.getElementById('authForm').reset();
        }

        function showAuthLoader(show) {
            const loader = document.getElementById('authLoader');
            const buttonText = document.getElementById('authButtonText');
            
            if (show) {
                loader.classList.remove('hidden');
                buttonText.classList.add('hidden');
            } else {
                loader.classList.add('hidden');
                buttonText.classList.remove('hidden');
            }
        }

        function showMainApp() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            // Update user info
            if (currentUser) {
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('userAvatar').textContent = currentUser.name.charAt(0).toUpperCase();
            }
            
            isLoggedIn = true;
        }

        // ============ Voice System ============
        function initializeVoice() {
            // Initialize speech recognition
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';

                recognition.onstart = () => {
                    document.getElementById('voiceBtn').classList.add('listening');
                    document.getElementById('voiceStatus').textContent = 'Listening... Speak now';
                };

                recognition.onend = () => {
                    document.getElementById('voiceBtn').classList.remove('listening');
                    document.getElementById('voiceStatus').textContent = 'Voice AI ready';
                };

                recognition.onerror = (event) => {
                    console.error('Speech recognition error:', event.error);
                    showNotification('Voice recognition error. Please try again.', 'error');
                };
            }

            // Initialize text-to-speech
            if ('speechSynthesis' in window) {
                speechSynthesis.onvoiceschanged = loadVoices;
                loadVoices();
            }
        }

        function loadVoices() {
            voices = speechSynthesis.getVoices();
            updateVoiceSelection();
        }

        function updateVoiceSelection() {
            const genderPreference = document.getElementById('voiceGender').value;
            
            selectedVoice = voices.find(voice => {
                const voiceName = voice.name.toLowerCase();
                if (genderPreference === 'female') {
                    return voiceName.includes('female') || voiceName.includes('samantha') || voiceName.includes('karen');
                } else {
                    return voiceName.includes('male') || voiceName.includes('daniel') || voiceName.includes('alex');
                }
            }) || voices[0];
        }

        function toggleVoice() {
            if (!recognition) {
                showNotification('Voice recognition not supported', 'error');
                return;
            }

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                processVoiceCommand(transcript);
            };

            recognition.start();
        }

        function processVoiceCommand(transcript) {
            console.log('Voice command:', transcript);
            
            // Task creation
            if (transcript.toLowerCase().includes('create task') || transcript.toLowerCase().includes('add task')) {
                const taskText = transcript.replace(/(create|add)\s*task\s*/i, '');
                document.getElementById('taskInput').value = taskText;
                createTask();
                return;
            }

            // ChatGPT
            if (transcript.toLowerCase().includes('ask chatgpt')) {
                const question = transcript.replace(/ask\s*chatgpt\s*/i, '');
                document.getElementById('chatInput').value = question;
                sendChatMessage();
                return;
            }

            // Default: send to ChatGPT
            document.getElementById('chatInput').value = transcript;
            sendChatMessage();
        }

        function updateVoice() {
            updateVoiceSelection();
            speak('Voice updated successfully');
        }

        function speak(text) {
            if ('speechSynthesis' in window && selectedVoice) {
                speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.voice = selectedVoice;
                utterance.rate = 0.9;
                speechSynthesis.speak(utterance);
            }
        }

        // ============ ChatGPT Integration ============
        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;

            // Add user message
            addChatMessage(message, 'user');
            input.value = '';

            // Add typing indicator
            addChatMessage('Thinking...', 'ai', true);

            try {
                const response = await callOpenRouter(message);
                removeTypingIndicator();
                addChatMessage(response, 'ai');
                speak(response.substring(0, 150)); // Speak first part
            } catch (error) {
                removeTypingIndicator();
                addChatMessage('Sorry, I encountered an error. Please try again.', 'ai');
                console.error('ChatGPT error:', error);
            }
        }

        async function callOpenRouter(message) {
            // This is where you'd make the actual API call
            // For now, return a simulated response
            return new Promise((resolve) => {
                setTimeout(() => {
                    const responses = [
                        `Great question! Based on your query about "${message}", here's what I think: This is a simulated response that would normally come from ChatGPT via OpenRouter API.`,
                        `I understand you're asking about "${message}". Let me help you with that! This is a demo response - in production, this would be powered by real ChatGPT.`,
                        `Excellent! Regarding "${message}", I can provide some insights: This demonstrates the ChatGPT integration that will work with your OpenRouter API key.`
                    ];
                    resolve(responses[Math.floor(Math.random() * responses.length)]);
                }, 2000);
            });
        }

        function addChatMessage(message, sender, isTyping = false) {
            const container = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            if (isTyping) messageDiv.classList.add('typing');
            
            if (sender === 'ai') {
                messageDiv.innerHTML = `<strong>ü§ñ ChatGPT:</strong> ${message}`;
            } else {
                messageDiv.innerHTML = `<strong>You:</strong> ${message}`;
            }
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function removeTypingIndicator() {
            const typing = document.querySelector('.message.typing');
            if (typing) typing.remove();
        }

        function startVoiceChat() {
            if (!recognition) {
                showNotification('Voice recognition not supported', 'error');
                return;
            }

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                document.getElementById('chatInput').value = transcript;
                sendChatMessage();
            };

            recognition.start();
        }

        // ============ Task Management ============
        function createTask() {
            const input = document.getElementById('taskInput');
            const taskText = input.value.trim();
            
            if (!taskText) {
                showNotification('Please enter a task', 'error');
                return;
            }

            const task = {
                id: Date.now(),
                title: taskText,
                completed: false,
                createdAt: new Date(),
                userId: currentUser?.id
            };

            tasks.push(task);
            input.value = '';
            
            renderTasks();
            updateStats();
            saveUserData();
            
            showNotification('Task created successfully!', 'success');
            speak(`Task created: ${taskText}`);
        }

        function startVoiceTask() {
            if (!recognition) {
                showNotification('Voice recognition not supported', 'error');
                return;
            }

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                document.getElementById('taskInput').value = transcript;
                createTask();
            };

            recognition.start();
        }

        function toggleTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (!task) return;

            task.completed = !task.completed;
            
            if (task.completed) {
                task.completedAt = new Date();
                completedTasks.push(task);
                showNotification('üéâ Task completed!', 'success');
                speak('Great job! Task completed!');
            } else {
                completedTasks = completedTasks.filter(t => t.id !== taskId);
            }

            renderTasks();
            updateStats();
            saveUserData();
        }

        function deleteTask(taskId) {
            if (confirm('Delete this task?')) {
                tasks = tasks.filter(t => t.id !== taskId);
                completedTasks = completedTasks.filter(t => t.id !== taskId);
                
                renderTasks();
                updateStats();
                saveUserData();
                
                showNotification('Task deleted', 'info');
            }
        }

        function renderTasks() {
            const container = document.getElementById('tasksList');
            
            if (tasks.length === 0) {
                container.innerHTML = `
                    <div class="text-center" style="padding: 40px; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üéØ</div>
                        <div>Your productivity journey starts here!</div>
                        <div>Create your first task above</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = tasks.map(task => `
                <div class="task-item ${task.completed ? 'completed' : ''}">
                    <div class="task-checkbox ${task.completed ? 'checked' : ''}" onclick="toggleTask(${task.id})">
                        ${task.completed ? '‚úì' : ''}
                    </div>
                    <div class="task-content">
                        <div class="task-title">${task.title}</div>
                        <div class="task-meta">
                            <span>Created: ${new Date(task.createdAt).toLocaleTimeString()}</span>
                        </div>
                    </div>
                    <button class="btn btn-secondary btn-small" onclick="deleteTask(${task.id})" title="Delete">
                        üóëÔ∏è
                    </button>
                </div>
            `).join('');

            updateProgress();
        }

        function updateProgress() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;

            // Update progress ring
            const circle = document.getElementById('progressCircle');
            const circumference = 2 * Math.PI * 60;
            const offset = circumference - (percentage / 100) * circumference;
            circle.style.strokeDashoffset = offset;

            document.getElementById('progressPercent').textContent = `${percentage}%`;

            // Update message
            const messages = {
                100: "Perfect day! üéâ You're unstoppable!",
                80: "Almost there! üåü Keep going!",
                60: "Great progress! üí™ You're doing amazing!",
                40: "Good momentum! üöÄ Keep it up!",
                20: "Getting started! ‚ú® Every step counts!",
                0: "Ready to achieve greatness! üéØ"
            };

            const messageKey = Object.keys(messages).reverse().find(key => percentage >= key);
            document.getElementById('dailyMessage').textContent = messages[messageKey];
        }

        function updateStats() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const rate = total > 0 ? Math.round((completed / total) * 100) : 0;

            document.getElementById('totalTasks').textContent = total;
            document.getElementById('completedTasks').textContent = completed;
            document.getElementById('completionRate').textContent = `${rate}%`;
            document.getElementById('streakCount').textContent = calculateStreak();

            // Update summary
            document.getElementById('tasksSummary').textContent = 
                total > 0 ? `${completed}/${total} completed today` : 'Ready to conquer your goals';
        }

        function calculateStreak() {
            const today = new Date().toDateString();
            const completedToday = tasks.filter(t => 
                t.completed && new Date(t.completedAt).toDateString() === today
            ).length;
            return completedToday;
        }

        // ============ Quote System ============
        function loadQuote() {
            const quotes = [
                { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney", category: "Action" },
                { text: "Innovation distinguishes between a leader and a follower.", author: "Steve Jobs", category: "Innovation" },
                { text: "Your limitation‚Äîit's only your imagination.", author: "Unknown", category: "Mindset" },
                { text: "Success doesn't just find you. You have to go out and get it.", author: "Unknown", category: "Success" },
                { text: "The harder you work for something, the greater you'll feel when you achieve it.", author: "Unknown", category: "Achievement" },
                { text: "Education is the most powerful weapon which you can use to change the world.", author: "Nelson Mandela", category: "Education" },
                { text: "The beautiful thing about learning is that nobody can take it away from you.", author: "B.B. King", category: "Learning" }
            ];

            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('quoteText').textContent = `"${randomQuote.text}"`;
            document.getElementById('quoteAuthor').textContent = `‚Äî ${randomQuote.author}`;
            document.getElementById('quoteCategory').textContent = randomQuote.category;
        }

        function getMotivation() {
            const userName = currentUser?.name || 'Champion';
            const motivations = [
                `${userName}, you're building something amazing! Keep going!`,
                `Every step forward matters, ${userName}! You've got this!`,
                `${userName}, your consistency is inspiring! Stay focused!`,
                `You're unstoppable, ${userName}! Keep pushing forward!`,
                `${userName}, your dedication will pay off! Keep working!`
            ];

            const motivation = motivations[Math.floor(Math.random() * motivations.length)];
            addChatMessage(motivation, 'ai');
            speak(motivation);
            loadQuote();
        }

        // ============ Theme Management ============
        function setTheme(theme) {
            document.body.setAttribute('data-theme', theme);
            
            // Update active button
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.toLowerCase() === theme);
            });
            
            showNotification(`Theme changed to ${theme}`, 'success');
            saveUserData();
        }

        // ============ Notification System ============
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            const icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span>${icon}</span>
                    <span style="flex: 1;">${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: inherit; cursor: pointer;">√ó</button>
                </div>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        // ============ Data Management ============
        function saveUserData() {
            if (currentUser) {
                const userData = {
                    user: currentUser,
                    tasks: tasks,
                    completedTasks: completedTasks,
                    theme: document.body.getAttribute('data-theme'),
                    lastSaved: new Date()
                };
                localStorage.setItem('flowstate-data', JSON.stringify(userData));
            }
        }

        function loadUserData() {
            const saved = localStorage.getItem('flowstate-data');
            if (saved) {
                const data = JSON.parse(saved);
                tasks = data.tasks || [];
                completedTasks = data.completedTasks || [];
                
                if (data.theme) {
                    setTheme(data.theme);
                }
                
                renderTasks();
                updateStats();
            }
        }

        // ============ User Menu ============
        function toggleUserMenu() {
            // Add dropdown functionality here if needed
            showNotification('User menu - Coming soon!', 'info');
        }

        // ============ Keyboard Shortcuts ============
        document.addEventListener('keypress', function(e) {
            if (e.target.id === 'chatInput' && e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendChatMessage();
            }
            
            if (e.target.id === 'taskInput' && e.key === 'Enter') {
                e.preventDefault();
                createTask();
            }
        });
    </script>
</body>
</html>

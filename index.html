<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlowState Pro - Ultimate AI Productivity Companion</title>
    <meta name="description" content="Ultimate AI productivity companion with real ChatGPT, cloud storage, voice AI, and intelligent task management">
    <meta name="theme-color" content="#3b82f6">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- External CDNs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Internal Styles and Scripts -->
    <link rel="stylesheet" href="styles.css">
</head>
<body data-theme="light">
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-logo">
            <div class="app-logo">FS</div>
            <h2>FlowState Pro</h2>
            <div class="loading-spinner"></div>
            <p>Initializing AI systems...</p>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div class="auth-modal hidden" id="authModal">
        <div class="auth-content">
            <div class="auth-logo">FS</div>
            <div class="auth-title" id="authTitle">Welcome to FlowState Pro</div>
            <div class="auth-subtitle" id="authSubtitle">Sign in to your account</div>
            
            <!-- Error/Success Messages -->
            <div class="message-display hidden" id="messageDisplay">
                <span id="messageText"></span>
                <button onclick="dismissMessage()" class="message-close">√ó</button>
            </div>
            
            <!-- Authentication Form -->
            <form class="auth-form" id="authForm">
                <input type="text" class="auth-input" id="nameInput" placeholder="Full Name" style="display: none;">
                <input type="number" class="auth-input" id="ageInput" placeholder="Age" min="13" max="120" style="display: none;">
                
                <div class="gender-selector" id="genderSelector" style="display: none;">
                    <label class="input-label">Gender</label>
                    <div class="gender-options">
                        <label class="radio-option">
                            <input type="radio" name="gender" value="male">
                            <span>Male</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="gender" value="female">
                            <span>Female</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="gender" value="other">
                            <span>Other</span>
                        </label>
                    </div>
                </div>
                
                <input type="email" class="auth-input" id="emailInput" placeholder="Email Address" required>
                <input type="password" class="auth-input" id="passwordInput" placeholder="Password" required>
                
                <button type="submit" class="auth-btn" id="authSubmitBtn">
                    <span id="authButtonText">Sign In</span>
                    <div id="authLoader" class="spinner hidden"></div>
                </button>
            </form>
            
            <div class="auth-switch">
                <span id="authSwitchText">Don't have an account?</span>
                <span class="auth-link" id="authSwitchLink">Create Account</span>
            </div>
            
            <div class="forgot-password">
                <span class="auth-link" onclick="showResetDialog()">Forgot Password?</span>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div class="app-container hidden" id="mainApp">
        <!-- Header -->
        <div class="app-header">
            <div class="app-title">
                <div class="app-logo">FS</div>
                <div>
                    <div class="app-name">FlowState Pro</div>
                    <div class="app-subtitle">Ultimate AI Productivity Companion</div>
                </div>
            </div>
            <div class="header-controls">
                <div class="theme-selector">
                    <button class="theme-btn active" data-theme="light">Light</button>
                    <button class="theme-btn" data-theme="dark">Dark</button>
                    <button class="theme-btn" data-theme="elegant">Elegant</button>
                </div>
                
                <div class="user-profile" id="userProfile">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-name" id="userName">User</div>
                    <div class="user-dropdown hidden" id="userDropdown">
                        <div class="dropdown-item" onclick="showProfile()">
                            <span>üë§</span> Profile
                        </div>
                        <div class="dropdown-item" onclick="showStats()">
                            <span>üìä</span> Statistics
                        </div>
                        <div class="dropdown-item" onclick="exportData()">
                            <span>üì§</span> Export Data
                        </div>
                        <div class="dropdown-item" onclick="importData()">
                            <span>üì•</span> Import Data
                        </div>
                        <div class="dropdown-item" onclick="showSettings()">
                            <span>‚öôÔ∏è</span> Settings
                        </div>
                        <div class="dropdown-item" onclick="logout()">
                            <span>üö™</span> Sign Out
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Voice Panel -->
        <div class="voice-panel">
            <div class="card-title">üé§ Voice AI Assistant</div>
            <div class="card-subtitle">Talk naturally with your AI productivity coach</div>
            
            <div class="voice-controls">
                <button class="voice-btn" id="voiceBtn">üé§</button>
                
                <div class="voice-settings">
                    <div class="voice-setting">
                        <label class="input-label">Voice Gender</label>
                        <select id="voiceGender" class="voice-select">
                            <option value="female">Female</option>
                            <option value="male">Male</option>
                        </select>
                    </div>
                    
                    <div class="voice-setting">
                        <label class="input-label">Voice Speed</label>
                        <select id="voiceSpeed" class="voice-select">
                            <option value="0.8">Slow</option>
                            <option value="0.9" selected>Normal</option>
                            <option value="1.0">Fast</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-secondary btn-small" onclick="testVoice()">Test Voice</button>
                </div>
                
                <div id="voiceStatus" class="voice-status">Voice AI ready - Click microphone to start</div>
            </div>
        </div>

        <!-- Dynamic Quote Display -->
        <div class="quote-display" id="quoteDisplay">
            <div class="quote-category" id="quoteCategory">Motivation</div>
            <div class="quote-text" id="quoteText">
                "The way to get started is to quit talking and begin doing."
            </div>
            <div class="quote-author" id="quoteAuthor">‚Äî Walt Disney</div>
        </div>

        <!-- Study Progress Section -->
        <div class="study-progress">
            <div class="card-title">üìö Study Progress Dashboard</div>
            <div class="card-subtitle">Comprehensive tracking of your learning sessions</div>
            
            <div class="study-stats">
                <div class="study-stat">
                    <div class="study-stat-number" id="totalStudyTime">0h 0m</div>
                    <div class="study-stat-label">Total Study Time</div>
                </div>
                <div class="study-stat">
                    <div class="study-stat-number" id="studyStreak">0</div>
                    <div class="study-stat-label">Study Streak (Days)</div>
                </div>
                <div class="study-stat">
                    <div class="study-stat-number" id="breaksTaken">0</div>
                    <div class="study-stat-label">Breaks Taken</div>
                </div>
            </div>

            <!-- Study Timer -->
            <div class="study-timer">
                <div class="timer-display" id="studyTimerDisplay">25:00</div>
                <div class="timer-controls">
                    <button class="btn btn-primary" id="startStudyBtn">üìö Start Study</button>
                    <button class="btn btn-secondary" id="pauseStudyBtn" disabled>‚è∏Ô∏è Pause</button>
                    <button class="btn btn-secondary" id="resetStudyBtn">üîÑ Reset</button>
                </div>
            </div>

            <!-- Break Controls -->
            <div class="break-controls">
                <div class="break-toggle">
                    <label class="toggle-switch">
                        <input type="checkbox" id="autoBreakToggle" checked>
                        <span class="slider"></span>
                    </label>
                    <span>Auto Break Intervals</span>
                </div>
                <select id="breakInterval" class="voice-select">
                    <option value="25">Every 25 min (Pomodoro)</option>
                    <option value="45">Every 45 min</option>
                    <option value="60">Every 60 min</option>
                </select>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="main-content">
            <!-- Left Panel -->
            <div class="left-panel">
                <!-- Real ChatGPT Integration -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">ü§ñ Real ChatGPT Assistant</div>
                        <div class="card-subtitle">Powered by OpenRouter - Ask anything!</div>
                    </div>
                    
                    <div class="chatgpt-container">
                        <div class="chat-messages" id="chatMessages">
                            <div class="message ai">
                                <strong>ü§ñ ChatGPT:</strong> Hello! I'm your real AI assistant powered by ChatGPT. I can help you with studying, productivity, coding, writing, and much more. What would you like to know?
                            </div>
                        </div>
                        
                        <div class="chat-input-container">
                            <textarea class="chat-input" id="chatInput" placeholder="Ask ChatGPT anything..." rows="3"></textarea>
                            <div class="chat-controls">
                                <button class="btn btn-primary" onclick="sendChatGPTMessage()">
                                    <span>üöÄ Send</span>
                                    <div class="spinner hidden" id="chatLoader"></div>
                                </button>
                                <button class="btn btn-secondary" onclick="startVoiceChatGPT()">üé§ Voice</button>
                                <button class="btn btn-secondary" onclick="clearChat()">üóëÔ∏è Clear</button>
                            </div>
                        </div>
                        
                        <!-- Quick Prompts -->
                        <div class="quick-prompts">
                            <button class="quick-prompt" onclick="quickChatGPT('Explain this concept in simple terms')">üìö Explain Concept</button>
                            <button class="quick-prompt" onclick="quickChatGPT('Help me study this topic effectively')">üéØ Study Help</button>
                            <button class="quick-prompt" onclick="quickChatGPT('Create a study plan for this subject')">üìã Study Plan</button>
                            <button class="quick-prompt" onclick="quickChatGPT('Give me motivation to keep studying')">üí™ Motivation</button>
                        </div>
                    </div>
                </div>

                <!-- Advanced Task Creator -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üéØ Advanced Task Creator</div>
                        <div class="card-subtitle">AI-powered task creation with voice and natural language</div>
                    </div>
                    
                    <div class="input-group">
                        <div class="input-wrapper">
                            <label class="input-label">Task Description</label>
                            <input type="text" class="input-field" id="taskInput" placeholder="e.g., 'Study mathematics for 90 minutes at 7 PM tomorrow'">
                        </div>
                        <button class="btn btn-primary" onclick="createTaskWithAI()">ü§ñ Create</button>
                        <button class="btn btn-secondary" onclick="startVoiceTaskCreation()">üé§ Voice</button>
                    </div>

                    <div class="quick-tasks">
                        <button class="btn btn-secondary btn-small" onclick="quickTask('study')">üìö Quick Study</button>
                        <button class="btn btn-secondary btn-small" onclick="quickTask('workout')">üí™ Workout</button>
                        <button class="btn btn-secondary btn-small" onclick="quickTask('break')">‚òï Break</button>
                        <button class="btn btn-secondary btn-small" onclick="quickTask('meeting')">üíº Meeting</button>
                    </div>

                    <div id="aiProcessing" class="ai-processing hidden">
                        <div class="processing-indicator">
                            <div class="spinner"></div>
                            <span>AI is analyzing your request...</span>
                        </div>
                    </div>
                </div>

                <!-- File Upload & Task Extraction -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üìÅ File Upload & Task Extraction</div>
                        <div class="card-subtitle">Upload documents to extract tasks automatically</div>
                    </div>
                    
                    <div class="upload-zone" id="uploadZone">
                        <div class="upload-icon">üìÅ</div>
                        <div class="upload-text">Drop files here or click to upload</div>
                        <div class="upload-subtext">Supports PDF, Excel, CSV, Images (OCR), Text files</div>
                        <input type="file" id="fileInput" multiple accept=".pdf,.xlsx,.xls,.csv,.txt,.jpg,.png,.jpeg" style="display: none;">
                        <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                            üì§ Choose Files
                        </button>
                    </div>
                    
                    <div id="uploadProgress" class="upload-progress hidden">
                        <div class="progress-bar">
                            <div class="progress-fill" id="uploadProgressBar"></div>
                        </div>
                        <div class="progress-text" id="uploadProgressText">Uploading...</div>
                    </div>
                    
                    <div id="extractedTasksPreview" class="extracted-tasks hidden">
                        <h4>üìã Extracted Tasks</h4>
                        <div id="extractedTasksList"></div>
                        <div class="extraction-controls">
                            <button class="btn btn-primary" onclick="importExtractedTasks()">‚úÖ Import All</button>
                            <button class="btn btn-secondary" onclick="reviewTasks()">üëÅÔ∏è Review</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel -->
            <div class="right-panel">
                <!-- Today's Tasks -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üìã Today's Mission</div>
                        <div class="card-subtitle" id="tasksSummary">Ready to conquer your goals</div>
                    </div>
                    
                    <div id="tasksList">
                        <div class="empty-state">
                            <div class="empty-icon">üéØ</div>
                            <div class="empty-title">Your productivity journey starts here!</div>
                            <div class="empty-subtitle">Create your first task above</div>
                        </div>
                    </div>
                </div>

                <!-- Progress Ring -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üèÜ Daily Achievement</div>
                        <div class="card-subtitle">Your progress matters</div>
                    </div>
                    
                    <div class="progress-ring-container">
                        <div class="progress-ring">
                            <svg>
                                <circle class="background" cx="70" cy="70" r="60"></circle>
                                <circle class="progress" cx="70" cy="70" r="60" id="progressCircle"></circle>
                            </svg>
                            <div class="progress-center">
                                <div class="progress-percent" id="progressPercent">0%</div>
                                <div class="progress-label">Complete</div>
                            </div>
                        </div>
                        
                        <div class="progress-message" id="dailyMessage">Ready to achieve greatness!</div>
                        <button class="btn btn-secondary btn-small" onclick="getPersonalMotivation()">üöÄ Motivate Me</button>
                    </div>
                </div>

                <!-- Analytics Dashboard -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üìä Advanced Analytics</div>
                        <div class="card-subtitle">Comprehensive productivity insights</div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="completionRate">0%</div>
                            <div class="stat-label">Completion Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalTime">0h</div>
                            <div class="stat-label">Time Today</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="streakCount">0</div>
                            <div class="stat-label">Day Streak</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalTasks">0</div>
                            <div class="stat-label">Total Tasks</div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <canvas id="progressChart" width="400" height="200"></canvas>
                    </div>
                </div>

                <!-- Individual Task Timers -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">‚è±Ô∏è Task Timers</div>
                        <div class="card-subtitle">Individual timers for each task</div>
                    </div>
                    
                    <div id="taskTimers">
                        <div class="no-timers">
                            <div class="empty-icon">‚è∞</div>
                            <div>No active timers</div>
                        </div>
                    </div>
                </div>

                <!-- Study Alarm System -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">‚è∞ Study Alarm System</div>
                        <div class="card-subtitle">Schedule your study sessions</div>
                    </div>
                    
                    <div class="alarm-creator">
                        <div class="input-group">
                            <div class="input-wrapper">
                                <label class="input-label">Study Subject</label>
                                <input type="text" class="input-field" id="alarmSubject" placeholder="e.g., Mathematics">
                            </div>
                            <div class="input-wrapper">
                                <label class="input-label">Time</label>
                                <input type="time" class="input-field" id="alarmTime">
                            </div>
                            <div class="input-wrapper">
                                <label class="input-label">Duration</label>
                                <select class="input-field" id="alarmDuration">
                                    <option value="25">25 minutes</option>
                                    <option value="45">45 minutes</option>
                                    <option value="60">1 hour</option>
                                    <option value="90">1.5 hours</option>
                                    <option value="120">2 hours</option>
                                </select>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" onclick="createStudyAlarm()">‚è∞ Set Alarm</button>
                    </div>
                    
                    <div id="activeAlarms" class="active-alarms"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Study Alarm Notification -->
    <div id="alarmNotification" class="alarm-notification hidden">
        <div class="alarm-content">
            <div class="alarm-icon">‚è∞</div>
            <div class="alarm-text">
                <h3 id="alarmTitle">Study Time!</h3>
                <p id="alarmMessage">Time to study Mathematics</p>
            </div>
            <div class="alarm-controls">
                <button class="btn btn-primary" onclick="startStudySession()">üìö Start</button>
                <button class="btn btn-secondary" onclick="snoozeAlarm()">üò¥ Snooze</button>
                <button class="btn btn-secondary" onclick="dismissAlarm()">‚ùå Dismiss</button>
            </div>
        </div>
    </div>

    <!-- Configuration Script -->
    <script src="config.js"></script>
    <!-- Main Application Script -->
    <script src="app.js"></script>
</body>
</html>

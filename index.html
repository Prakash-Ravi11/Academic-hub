<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academic Hub - AI Learning Platform</title>
    <meta name="description" content="Advanced AI-powered academic platform with subject-based storage and progress tracking">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.0.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.0.0/dist/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        :root {
            --bg-primary: linear-gradient(135deg, #0a0b1e 0%, #1a1b2e 50%, #2d3748 100%);
            --bg-secondary: rgba(26, 32, 44, 0.95);
            --bg-tertiary: rgba(45, 55, 72, 0.9);
            --bg-card: rgba(30, 41, 59, 0.9);
            --text-primary: #ffffff;
            --text-secondary: #a0aec0;
            --text-muted: #64748b;
            --primary-color: #4299e1;
            --success-color: #48bb78;
            --warning-color: #ed8936;
            --danger-color: #f56565;
            --border-color: rgba(160, 174, 192, 0.2);
            --shadow-primary: 0 25px 50px rgba(0, 0, 0, 0.5);
            --shadow-secondary: 0 10px 25px rgba(0, 0, 0, 0.3);
            --academia-gradient: linear-gradient(135deg, #4299e1, #3182ce);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Auth Modal */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .auth-content {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 48px;
            width: 400px;
            text-align: center;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-primary);
        }

        .auth-logo {
            width: 80px;
            height: 80px;
            background: var(--academia-gradient);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: 700;
            margin: 0 auto 32px;
        }

        .auth-input {
            width: 100%;
            padding: 16px 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            font-size: 16px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            margin-bottom: 16px;
            outline: none;
        }

        .auth-btn {
            width: 100%;
            padding: 16px 32px;
            background: var(--academia-gradient);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        /* Main App */
        .app-container {
            display: none;
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding: 20px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .app-title {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .app-logo {
            width: 56px;
            height: 56px;
            background: var(--academia-gradient);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: 700;
        }

        .app-name {
            font-size: 36px;
            font-weight: 800;
            color: var(--text-primary);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            background: var(--bg-tertiary);
            border-radius: 12px;
            cursor: pointer;
        }

        /* Subject Cards Grid */
        .subjects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .subject-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 24px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-secondary);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .subject-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--academia-gradient);
        }

        .subject-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-primary);
        }

        .subject-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .subject-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .subject-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .subject-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 20px;
        }

        /* Progress Ring for Each Subject */
        .subject-progress {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .progress-ring {
            width: 80px;
            height: 80px;
            position: relative;
        }

        .progress-ring svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .progress-ring circle {
            fill: none;
            stroke-width: 6;
            stroke-linecap: round;
        }

        .progress-bg {
            stroke: var(--border-color);
        }

        .progress-bar {
            stroke: var(--primary-color);
            stroke-dasharray: 188;
            stroke-dashoffset: 188;
            transition: stroke-dashoffset 1s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 14px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .progress-info {
            flex: 1;
        }

        .progress-time {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .progress-target {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Subject Controls */
        .subject-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .control-btn {
            padding: 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            text-align: center;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .control-btn.active {
            background: var(--primary-color);
            color: white;
        }

        /* File Storage Area */
        .file-storage {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
            border: 2px dashed var(--border-color);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-storage:hover {
            border-color: var(--primary-color);
            background: rgba(66, 153, 225, 0.1);
        }

        .file-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 12px;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .file-name {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .file-size {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .file-actions {
            display: flex;
            gap: 8px;
        }

        .file-btn {
            padding: 4px 8px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 12px;
        }

        .file-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        /* Timer Display */
        .timer-display {
            font-family: 'Courier New', monospace;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
            text-align: center;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 12px;
            margin: 16px 0;
            border: 1px solid var(--border-color);
        }

        .timer-controls {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 16px;
        }

        .timer-btn {
            padding: 12px 24px;
            background: var(--academia-gradient);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .timer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(66, 153, 225, 0.3);
        }

        .timer-btn.pause {
            background: var(--warning-color);
        }

        .timer-btn.stop {
            background: var(--danger-color);
        }

        /* AI Features Panel */
        .ai-panel {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-secondary);
        }

        .ai-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chat-area {
            height: 300px;
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 16px;
            overflow-y: auto;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
        }

        .message {
            margin-bottom: 16px;
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .message.user {
            background: var(--academia-gradient);
            color: white;
            margin-left: auto;
            text-align: right;
        }

        .message.ai {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .input-group {
            display: flex;
            gap: 12px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            outline: none;
        }

        .btn {
            padding: 12px 24px;
            background: var(--academia-gradient);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .subjects-grid {
                grid-template-columns: 1fr;
            }
            
            .app-container {
                padding: 16px;
            }
            
            .subject-controls {
                grid-template-columns: 1fr;
            }
        }

        .hidden { display: none !important; }
        .show { display: flex !important; }
    </style>
</head>
<body>
    <!-- Authentication Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-content">
            <div class="auth-logo">AH</div>
            <h1 style="font-size: 32px; font-weight: 700; margin-bottom: 12px;">Academic Hub</h1>
            <p style="color: var(--text-secondary); margin-bottom: 32px;">Access your AI-powered learning platform</p>
            
            <input type="text" class="auth-input" id="nameInput" placeholder="Your Name" required>
            <input type="password" class="auth-input" id="passwordInput" placeholder="Create Password" required>
            <button class="auth-btn" onclick="login()">Access Platform</button>
            
            <div style="margin-top: 24px; color: var(--text-secondary); font-size: 14px;">
                <span>New to Academic Hub? </span>
                <span style="color: var(--primary-color); cursor: pointer;" onclick="toggleAuthMode()">Create Account</span>
            </div>
        </div>
    </div>

    <!-- Main Academic Hub App -->
    <div class="app-container" id="mainApp">
        <!-- Header -->
        <div class="app-header">
            <div class="app-title">
                <div class="app-logo">AH</div>
                <div>
                    <div class="app-name">Academic Hub</div>
                    <div style="font-size: 16px; color: var(--text-secondary);">AI-Powered Learning Platform</div>
                </div>
            </div>
            <div class="user-profile" onclick="logout()">
                <div style="width: 32px; height: 32px; background: var(--academia-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700;" id="userAvatar">U</div>
                <div id="userName">User</div>
            </div>
        </div>

        <!-- AI Assistant Panel -->
        <div class="ai-panel">
            <div class="ai-title">🧠 AI Academic Assistant</div>
            <div class="chat-area" id="chatArea"></div>
            <div class="input-group">
                <input type="text" class="chat-input" id="chatInput" placeholder="Ask about any subject or get help...">
                <button class="btn" onclick="sendMessage()">Send</button>
                <button class="btn" style="background: var(--success-color);" onclick="toggleVoice()">🎤</button>
            </div>
        </div>

        <!-- Subjects Grid -->
        <div class="subjects-grid" id="subjectsGrid">
            <!-- Mathematics Subject -->
            <div class="subject-card" data-subject="mathematics">
                <div class="subject-icon">📐</div>
                <div class="subject-title">Mathematics</div>
                <div class="subject-subtitle">Algebra, Calculus, Geometry, Statistics</div>
                
                <div class="subject-progress">
                    <div class="progress-ring">
                        <svg>
                            <circle class="progress-bg" cx="40" cy="40" r="30"></circle>
                            <circle class="progress-bar" cx="40" cy="40" r="30" data-progress="0"></circle>
                        </svg>
                        <div class="progress-text">0%</div>
                    </div>
                    <div class="progress-info">
                        <div class="progress-time">0h 0m</div>
                        <div class="progress-target">of 4h daily goal</div>
                    </div>
                </div>
                
                <div class="subject-controls">
                    <div class="control-btn" onclick="startStudying('mathematics')">📚 Study</div>
                    <div class="control-btn" onclick="openFiles('mathematics')">📁 Files</div>
                    <div class="control-btn" onclick="openNotes('mathematics')">📝 Notes</div>
                </div>
                
                <div class="file-storage" onclick="uploadFile('mathematics')">
                    <div>📎 Drop files here or click to upload</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">PDF, DOC, PPT, Images supported</div>
                </div>
                <div class="file-list" id="files-mathematics"></div>
            </div>

            <!-- Science Subject -->
            <div class="subject-card" data-subject="science">
                <div class="subject-icon">🔬</div>
                <div class="subject-title">Science</div>
                <div class="subject-subtitle">Physics, Chemistry, Biology</div>
                
                <div class="subject-progress">
                    <div class="progress-ring">
                        <svg>
                            <circle class="progress-bg" cx="40" cy="40" r="30"></circle>
                            <circle class="progress-bar" cx="40" cy="40" r="30" data-progress="0"></circle>
                        </svg>
                        <div class="progress-text">0%</div>
                    </div>
                    <div class="progress-info">
                        <div class="progress-time">0h 0m</div>
                        <div class="progress-target">of 4h daily goal</div>
                    </div>
                </div>
                
                <div class="subject-controls">
                    <div class="control-btn" onclick="startStudying('science')">📚 Study</div>
                    <div class="control-btn" onclick="openFiles('science')">📁 Files</div>
                    <div class="control-btn" onclick="openNotes('science')">📝 Notes</div>
                </div>
                
                <div class="file-storage" onclick="uploadFile('science')">
                    <div>📎 Drop files here or click to upload</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">PDF, DOC, PPT, Images supported</div>
                </div>
                <div class="file-list" id="files-science"></div>
            </div>

            <!-- History Subject -->
            <div class="subject-card" data-subject="history">
                <div class="subject-icon">📚</div>
                <div class="subject-title">History</div>
                <div class="subject-subtitle">World History, Ancient Civilizations</div>
                
                <div class="subject-progress">
                    <div class="progress-ring">
                        <svg>
                            <circle class="progress-bg" cx="40" cy="40" r="30"></circle>
                            <circle class="progress-bar" cx="40" cy="40" r="30" data-progress="0"></circle>
                        </svg>
                        <div class="progress-text">0%</div>
                    </div>
                    <div class="progress-info">
                        <div class="progress-time">0h 0m</div>
                        <div class="progress-target">of 4h daily goal</div>
                    </div>
                </div>
                
                <div class="subject-controls">
                    <div class="control-btn" onclick="startStudying('history')">📚 Study</div>
                    <div class="control-btn" onclick="openFiles('history')">📁 Files</div>
                    <div class="control-btn" onclick="openNotes('history')">📝 Notes</div>
                </div>
                
                <div class="file-storage" onclick="uploadFile('history')">
                    <div>📎 Drop files here or click to upload</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">PDF, DOC, PPT, Images supported</div>
                </div>
                <div class="file-list" id="files-history"></div>
            </div>

            <!-- Literature Subject -->
            <div class="subject-card" data-subject="literature">
                <div class="subject-icon">📖</div>
                <div class="subject-title">Literature</div>
                <div class="subject-subtitle">English, Poetry, Creative Writing</div>
                
                <div class="subject-progress">
                    <div class="progress-ring">
                        <svg>
                            <circle class="progress-bg" cx="40" cy="40" r="30"></circle>
                            <circle class="progress-bar" cx="40" cy="40" r="30" data-progress="0"></circle>
                        </svg>
                        <div class="progress-text">0%</div>
                    </div>
                    <div class="progress-info">
                        <div class="progress-time">0h 0m</div>
                        <div class="progress-target">of 4h daily goal</div>
                    </div>
                </div>
                
                <div class="subject-controls">
                    <div class="control-btn" onclick="startStudying('literature')">📚 Study</div>
                    <div class="control-btn" onclick="openFiles('literature')">📁 Files</div>
                    <div class="control-btn" onclick="openNotes('literature')">📝 Notes</div>
                </div>
                
                <div class="file-storage" onclick="uploadFile('literature')">
                    <div>📎 Drop files here or click to upload</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">PDF, DOC, PPT, Images supported</div>
                </div>
                <div class="file-list" id="files-literature"></div>
            </div>

            <!-- Programming Subject -->
            <div class="subject-card" data-subject="programming">
                <div class="subject-icon">💻</div>
                <div class="subject-title">Programming</div>
                <div class="subject-subtitle">JavaScript, Python, Web Development</div>
                
                <div class="subject-progress">
                    <div class="progress-ring">
                        <svg>
                            <circle class="progress-bg" cx="40" cy="40" r="30"></circle>
                            <circle class="progress-bar" cx="40" cy="40" r="30" data-progress="0"></circle>
                        </svg>
                        <div class="progress-text">0%</div>
                    </div>
                    <div class="progress-info">
                        <div class="progress-time">0h 0m</div>
                        <div class="progress-target">of 4h daily goal</div>
                    </div>
                </div>
                
                <div class="subject-controls">
                    <div class="control-btn" onclick="startStudying('programming')">📚 Study</div>
                    <div class="control-btn" onclick="openFiles('programming')">📁 Files</div>
                    <div class="control-btn" onclick="openNotes('programming')">📝 Notes</div>
                </div>
                
                <div class="file-storage" onclick="uploadFile('programming')">
                    <div>📎 Drop files here or click to upload</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">PDF, DOC, PPT, Images supported</div>
                </div>
                <div class="file-list" id="files-programming"></div>
            </div>

            <!-- Languages Subject -->
            <div class="subject-card" data-subject="languages">
                <div class="subject-icon">🗣️</div>
                <div class="subject-title">Languages</div>
                <div class="subject-subtitle">Spanish, French, German</div>
                
                <div class="subject-progress">
                    <div class="progress-ring">
                        <svg>
                            <circle class="progress-bg" cx="40" cy="40" r="30"></circle>
                            <circle class="progress-bar" cx="40" cy="40" r="30" data-progress="0"></circle>
                        </svg>
                        <div class="progress-text">0%</div>
                    </div>
                    <div class="progress-info">
                        <div class="progress-time">0h 0m</div>
                        <div class="progress-target">of 4h daily goal</div>
                    </div>
                </div>
                
                <div class="subject-controls">
                    <div class="control-btn" onclick="startStudying('languages')">📚 Study</div>
                    <div class="control-btn" onclick="openFiles('languages')">📁 Files</div>
                    <div class="control-btn" onclick="openNotes('languages')">📝 Notes</div>
                </div>
                
                <div class="file-storage" onclick="uploadFile('languages')">
                    <div>📎 Drop files here or click to upload</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">PDF, DOC, PPT, Images supported</div>
                </div>
                <div class="file-list" id="files-languages"></div>
            </div>
        </div>
    </div>

    <!-- Study Timer Modal -->
    <div class="modal" id="timerModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="timerSubject">Studying Mathematics</div>
                <button class="close-btn" onclick="closeTimer()">&times;</button>
            </div>
            
            <div class="timer-display" id="timerDisplay">00:00:00</div>
            
            <div class="timer-controls">
                <button class="timer-btn" id="startBtn" onclick="startTimer()">▶️ Start</button>
                <button class="timer-btn pause" id="pauseBtn" onclick="pauseTimer()" style="display: none;">⏸️ Pause</button>
                <button class="timer-btn stop" id="stopBtn" onclick="stopTimer()" style="display: none;">⏹️ Stop</button>
            </div>
            
            <div style="margin-top: 24px; text-align: center; color: var(--text-secondary);">
                <div>Daily Goal: 4 hours</div>
                <div id="sessionGoal">Session Goal: Focus and learn</div>
            </div>
        </div>
    </div>

    <!-- File Manager Modal -->
    <div class="modal" id="fileModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="fileModalTitle">Subject Files</div>
                <button class="close-btn" onclick="closeFileModal()">&times;</button>
            </div>
            
            <div style="margin-bottom: 20px;">
                <button class="btn" onclick="uploadFile(currentSubject)">📎 Upload New File</button>
            </div>
            
            <div id="fileManagerContent">
                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <div style="font-size: 48px; margin-bottom: 16px;">📁</div>
                    <div>No files uploaded yet</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application State
        let currentUser = null;
        let isSignUpMode = false;
        let currentSubject = null;
        let studyTimers = {};
        let studyProgress = {};
        let subjectFiles = {};
        let isVoiceActive = false;
        let recognition = null;

        // Academic subjects data
        const subjects = {
            mathematics: {
                name: 'Mathematics',
                icon: '📐',
                description: 'Algebra, Calculus, Geometry, Statistics',
                dailyGoal: 4 * 60, // 4 hours in minutes
                timeStudied: 0
            },
            science: {
                name: 'Science',
                icon: '🔬',
                description: 'Physics, Chemistry, Biology',
                dailyGoal: 4 * 60,
                timeStudied: 0
            },
            history: {
                name: 'History',
                icon: '📚',
                description: 'World History, Ancient Civilizations',
                dailyGoal: 4 * 60,
                timeStudied: 0
            },
            literature: {
                name: 'Literature',
                icon: '📖',
                description: 'English, Poetry, Creative Writing',
                dailyGoal: 4 * 60,
                timeStudied: 0
            },
            programming: {
                name: 'Programming',
                icon: '💻',
                description: 'JavaScript, Python, Web Development',
                dailyGoal: 4 * 60,
                timeStudied: 0
            },
            languages: {
                name: 'Languages',
                icon: '🗣️',
                description: 'Spanish, French, German',
                dailyGoal: 4 * 60,
                timeStudied: 0
            }
        };

        // Users database
        const users = JSON.parse(localStorage.getItem('academic-hub-users') || '{}');

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎓 Academic Hub Loading...');
            
            // Check existing session
            const savedUser = localStorage.getItem('academic-hub-current-user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainApp();
                loadUserData();
            }
            
            // Initialize voice recognition
            initializeVoiceRecognition();
            
            // Initialize file drag and drop
            initializeFileHandling();
            
            console.log('✅ Academic Hub Ready!');
        });

        // Authentication Functions
        function login() {
            const name = document.getElementById('nameInput').value.trim();
            const password = document.getElementById('passwordInput').value.trim();
            
            if (!name || !password) {
                alert('Please fill in all fields');
                return;
            }
            
            const userKey = name.toLowerCase();
            
            if (isSignUpMode) {
                // Create Account
                if (users[userKey]) {
                    alert('Account already exists');
                    return;
                }
                
                const newUser = {
                    name: name,
                    password: password,
                    createdAt: new Date().toISOString(),
                    subjects: {...subjects},
                    files: {}
                };
                
                users[userKey] = newUser;
                localStorage.setItem('academic-hub-users', JSON.stringify(users));
                currentUser = newUser;
                localStorage.setItem('academic-hub-current-user', JSON.stringify(currentUser));
                
                showMainApp();
            } else {
                // Sign In
                if (users[userKey] && users[userKey].password === password) {
                    currentUser = users[userKey];
                    localStorage.setItem('academic-hub-current-user', JSON.stringify(currentUser));
                    showMainApp();
                    loadUserData();
                } else {
                    alert('Invalid credentials');
                }
            }
        }

        function toggleAuthMode() {
            isSignUpMode = !isSignUpMode;
            // Update UI for sign up/sign in mode
        }

        function showMainApp() {
            document.getElementById('authModal').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            if (currentUser) {
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('userAvatar').textContent = currentUser.name.charAt(0).toUpperCase();
                
                // Welcome message
                setTimeout(() => {
                    addChatMessage(`🎓 Welcome back, ${currentUser.name}! I'm your AI academic assistant. I can help you with any subject, track your study progress, and manage your learning materials. What would you like to study today?`, 'ai');
                }, 1000);
            }
        }

        function logout() {
            if (confirm('Are you sure you want to sign out?')) {
                saveUserData();
                currentUser = null;
                localStorage.removeItem('academic-hub-current-user');
                location.reload();
            }
        }

        // Data Management
        function loadUserData() {
            if (currentUser) {
                // Load subject progress
                if (currentUser.subjects) {
                    Object.assign(subjects, currentUser.subjects);
                }
                
                // Load files
                subjectFiles = currentUser.files || {};
                
                // Update UI
                updateAllProgress();
                renderAllFiles();
            }
        }

        function saveUserData() {
            if (currentUser) {
                currentUser.subjects = subjects;
                currentUser.files = subjectFiles;
                
                const userKey = currentUser.name.toLowerCase();
                users[userKey] = currentUser;
                
                localStorage.setItem('academic-hub-users', JSON.stringify(users));
                localStorage.setItem('academic-hub-current-user', JSON.stringify(currentUser));
            }
        }

        // Study Timer Functions
        function startStudying(subject) {
            currentSubject = subject;
            document.getElementById('timerSubject').textContent = `Studying ${subjects[subject].name}`;
            document.getElementById('timerModal').style.display = 'flex';
            
            // Reset timer display
            document.getElementById('timerDisplay').textContent = '00:00:00';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'none';
        }

        function startTimer() {
            if (!currentSubject) return;
            
            const startTime = Date.now();
            studyTimers[currentSubject] = {
                startTime: startTime,
                pausedTime: 0,
                interval: setInterval(() => updateTimerDisplay(currentSubject), 1000)
            };
            
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'inline-block';
            
            showNotification('⏱️ Timer Started', `Study session for ${subjects[currentSubject].name} has begun!`);
        }

        function pauseTimer() {
            if (studyTimers[currentSubject]) {
                clearInterval(studyTimers[currentSubject].interval);
                studyTimers[currentSubject].pausedTime = Date.now() - studyTimers[currentSubject].startTime;
                
                document.getElementById('startBtn').style.display = 'inline-block';
                document.getElementById('pauseBtn').style.display = 'none';
                
                showNotification('⏸️ Timer Paused', 'Study session paused');
            }
        }

        function stopTimer() {
            if (studyTimers[currentSubject]) {
                const totalTime = Math.floor((Date.now() - studyTimers[currentSubject].startTime) / 1000 / 60); // minutes
                subjects[currentSubject].timeStudied += totalTime;
                
                clearInterval(studyTimers[currentSubject].interval);
                delete studyTimers[currentSubject];
                
                closeTimer();
                updateProgress(currentSubject);
                saveUserData();
                
                showNotification('✅ Study Session Complete', `Great job! You studied ${subjects[currentSubject].name} for ${totalTime} minutes.`);
                addChatMessage(`🎉 Excellent work! You just completed a ${totalTime}-minute study session in ${subjects[currentSubject].name}. Your daily progress has been updated. Keep up the great momentum! 💪`, 'ai');
            }
        }

        function updateTimerDisplay(subject) {
            if (!studyTimers[subject]) return;
            
            const elapsed = Date.now() - studyTimers[subject].startTime;
            const totalSeconds = Math.floor(elapsed / 1000);
            
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            
            const display = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timerDisplay').textContent = display;
        }

        function closeTimer() {
            document.getElementById('timerModal').style.display = 'none';
            currentSubject = null;
        }

        // Progress Tracking
        function updateProgress(subject) {
            const subjectData = subjects[subject];
            const percentage = Math.min((subjectData.timeStudied / subjectData.dailyGoal) * 100, 100);
            
            // Update progress ring
            const card = document.querySelector(`[data-subject="${subject}"]`);
            const progressBar = card.querySelector('.progress-bar');
            const progressText = card.querySelector('.progress-text');
            const progressTime = card.querySelector('.progress-time');
            
            const circumference = 2 * Math.PI * 30;
            const offset = circumference - (percentage / 100) * circumference;
            
            progressBar.style.strokeDashoffset = offset;
            progressText.textContent = Math.round(percentage) + '%';
            
            const hours = Math.floor(subjectData.timeStudied / 60);
            const minutes = subjectData.timeStudied % 60;
            progressTime.textContent = `${hours}h ${minutes}m`;
        }

        function updateAllProgress() {
            Object.keys(subjects).forEach(subject => {
                updateProgress(subject);
            });
        }

        // File Management
        function initializeFileHandling() {
            // Add drag and drop support
            document.querySelectorAll('.file-storage').forEach(storage => {
                storage.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    storage.style.borderColor = 'var(--primary-color)';
                    storage.style.background = 'rgba(66, 153, 225, 0.1)';
                });
                
                storage.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    storage.style.borderColor = 'var(--border-color)';
                    storage.style.background = 'var(--bg-tertiary)';
                });
                
                storage.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const subject = storage.closest('[data-subject]').dataset.subject;
                    const files = Array.from(e.dataTransfer.files);
                    handleFileUpload(subject, files);
                    
                    storage.style.borderColor = 'var(--border-color)';
                    storage.style.background = 'var(--bg-tertiary)';
                });
            });
        }

        function uploadFile(subject) {
            const input = document.createElement('input');
            input.type = 'file';
            input.multiple = true;
            input.accept = '.pdf,.doc,.docx,.ppt,.pptx,.txt,.jpg,.jpeg,.png,.gif';
            
            input.onchange = (e) => {
                const files = Array.from(e.target.files);
                handleFileUpload(subject, files);
            };
            
            input.click();
        }

        function handleFileUpload(subject, files) {
            if (!subjectFiles[subject]) {
                subjectFiles[subject] = [];
            }
            
            files.forEach(file => {
                // In a real app, you would upload to a server or cloud storage
                // For this demo, we'll use localStorage with base64 encoding for small files
                if (file.size > 5 * 1024 * 1024) { // 5MB limit for demo
                    showNotification('⚠️ File Too Large', `${file.name} is too large. Please upload files under 5MB.`);
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const fileData = {
                        id: Date.now() + Math.random(),
                        name: file.name,
                        size: file.size,
                        type: file.type,
                        data: e.target.result, // base64 data
                        uploadedAt: new Date().toISOString()
                    };
                    
                    subjectFiles[subject].push(fileData);
                    renderFiles(subject);
                    saveUserData();
                    
                    showNotification('✅ File Uploaded', `${file.name} has been saved to ${subjects[subject].name}`);
                };
                reader.readAsDataURL(file);
            });
        }

        function renderFiles(subject) {
            const container = document.getElementById(`files-${subject}`);
            const files = subjectFiles[subject] || [];
            
            if (files.length === 0) {
                container.innerHTML = '';
                return;
            }
            
            container.innerHTML = files.map(file => `
                <div class="file-item">
                    <div>
                        <div class="file-name">${file.name}</div>
                        <div class="file-size">${formatFileSize(file.size)}</div>
                    </div>
                    <div class="file-actions">
                        <button class="file-btn" onclick="downloadFile('${subject}', '${file.id}')">📥 Download</button>
                        <button class="file-btn" onclick="deleteFile('${subject}', '${file.id}')">🗑️ Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function renderAllFiles() {
            Object.keys(subjects).forEach(subject => {
                renderFiles(subject);
            });
        }

        function downloadFile(subject, fileId) {
            const file = subjectFiles[subject].find(f => f.id == fileId);
            if (file) {
                const link = document.createElement('a');
                link.href = file.data;
                link.download = file.name;
                link.click();
                
                showNotification('📥 Download Started', `Downloading ${file.name}`);
            }
        }

        function deleteFile(subject, fileId) {
            if (confirm('Are you sure you want to delete this file?')) {
                subjectFiles[subject] = subjectFiles[subject].filter(f => f.id != fileId);
                renderFiles(subject);
                saveUserData();
                showNotification('🗑️ File Deleted', 'File has been removed');
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function openFiles(subject) {
            currentSubject = subject;
            document.getElementById('fileModalTitle').textContent = `${subjects[subject].name} Files`;
            
            const content = document.getElementById('fileManagerContent');
            const files = subjectFiles[subject] || [];
            
            if (files.length === 0) {
                content.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">📁</div>
                        <div>No files uploaded yet</div>
                        <div style="font-size: 14px; margin-top: 8px;">Upload study materials, notes, and resources</div>
                    </div>
                `;
            } else {
                content.innerHTML = `
                    <div class="file-list">
                        ${files.map(file => `
                            <div class="file-item">
                                <div>
                                    <div class="file-name">${file.name}</div>
                                    <div class="file-size">${formatFileSize(file.size)} • ${new Date(file.uploadedAt).toLocaleDateString()}</div>
                                </div>
                                <div class="file-actions">
                                    <button class="file-btn" onclick="downloadFile('${subject}', '${file.id}')">📥 Download</button>
                                    <button class="file-btn" onclick="deleteFile('${subject}', '${file.id}')">🗑️ Delete</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            document.getElementById('fileModal').style.display = 'flex';
        }

        function closeFileModal() {
            document.getElementById('fileModal').style.display = 'none';
            currentSubject = null;
        }

        function openNotes(subject) {
            addChatMessage(`📝 Opening notes for ${subjects[subject].name}. You can ask me to help you take notes, summarize topics, or create study guides for this subject!`, 'ai');
        }

        // Voice Recognition
        function initializeVoiceRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';
                
                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    processVoiceCommand(transcript);
                };
                
                recognition.onend = () => {
                    isVoiceActive = false;
                };
            }
        }

        function toggleVoice() {
            if (!recognition) {
                showNotification('❌ Voice Not Supported', 'Voice recognition is not available in this browser');
                return;
            }
            
            if (isVoiceActive) {
                recognition.stop();
                isVoiceActive = false;
            } else {
                recognition.start();
                isVoiceActive = true;
                showNotification('🎤 Listening', 'Voice recognition activated');
            }
        }

        function processVoiceCommand(transcript) {
            console.log('Voice command:', transcript);
            document.getElementById('chatInput').value = transcript;
            sendMessage();
        }

        // AI Chat Functions
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addChatMessage(message, 'user');
            input.value = '';
            
            setTimeout(() => {
                const response = generateAIResponse(message);
                addChatMessage(response, 'ai');
                speak(response.replace(/🎓|📚|🔬|💻/g, ''));
            }, 1000);
        }

        function addChatMessage(message, sender) {
            const chatArea = document.getElementById('chatArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.innerHTML = sender === 'ai' ? `<strong>🎓 Academic AI:</strong> ${message}` : `<strong>You:</strong> ${message}`;
            
            chatArea.appendChild(messageDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            const userName = currentUser ? currentUser.name : 'student';
            
            // Subject-specific responses
            if (lowerMessage.includes('math') || lowerMessage.includes('mathematics')) {
                return `📐 I can help you with mathematics, ${userName}! Whether it's algebra, calculus, geometry, or statistics, I'm here to explain concepts, solve problems step-by-step, and help you understand the fundamentals. What specific math topic would you like to explore?`;
            }
            
            if (lowerMessage.includes('science') || lowerMessage.includes('physics') || lowerMessage.includes('chemistry') || lowerMessage.includes('biology')) {
                return `🔬 Science is fascinating, ${userName}! I can assist with physics concepts like motion and energy, chemistry topics like molecular structures and reactions, and biology subjects like cellular processes and genetics. What scientific area interests you today?`;
            }
            
            if (lowerMessage.includes('history')) {
                return `📚 History helps us understand our world, ${userName}! I can discuss different civilizations, historical events, analyze causes and effects, and help you understand how past events shape our present. What historical period or topic would you like to explore?`;
            }
            
            if (lowerMessage.includes('literature') || lowerMessage.includes('english') || lowerMessage.includes('writing')) {
                return `📖 Literature opens new worlds, ${userName}! I can help analyze poems, novels, and plays, discuss literary devices and themes, assist with essay writing, and improve your reading comprehension. What literary work or writing project are you working on?`;
            }
            
            if (lowerMessage.includes('programming') || lowerMessage.includes('coding') || lowerMessage.includes('computer')) {
                return `💻 Programming is a powerful skill, ${userName}! I can help with JavaScript, Python, web development, algorithms, debugging, and software design principles. Whether you're a beginner or advanced, what coding challenge can I help you with?`;
            }
            
            if (lowerMessage.includes('language') || lowerMessage.includes('spanish') || lowerMessage.includes('french') || lowerMessage.includes('german')) {
                return `🗣️ Language learning is exciting, ${userName}! I can help with grammar, vocabulary, pronunciation, conversation practice, and cultural context. Which language are you studying, and what specific aspect would you like to work on?`;
            }
            
            // Study-related responses
            if (lowerMessage.includes('study') || lowerMessage.includes('learn') || lowerMessage.includes('exam') || lowerMessage.includes('test')) {
                return `📚 Great question about studying, ${userName}! I can help you create effective study schedules, suggest memory techniques like active recall and spaced repetition, provide test-taking strategies, and help you stay motivated. What study challenge are you facing?`;
            }
            
            // Progress-related responses
            if (lowerMessage.includes('progress') || lowerMessage.includes('goal') || lowerMessage.includes('time')) {
                const totalStudied = Object.values(subjects).reduce((sum, subject) => sum + subject.timeStudied, 0);
                const totalGoal = Object.values(subjects).length * 4 * 60; // 4 hours per subject
                const overallProgress = Math.round((totalStudied / totalGoal) * 100);
                
                return `📊 You're making excellent progress, ${userName}! You've studied ${Math.floor(totalStudied / 60)} hours and ${totalStudied % 60} minutes today across all subjects. Your overall daily progress is ${overallProgress}%. Remember, consistency is key to academic success. Keep up the great work!`;
            }
            
            // General responses
            const responses = [
                `Hello ${userName}! I'm your AI academic assistant, ready to help you excel in your studies. I can assist with any subject, track your progress, help manage your study materials, and provide personalized learning guidance. What would you like to work on today?`,
                `Great to see you learning, ${userName}! I'm here to support your academic journey with explanations, study strategies, progress tracking, and motivation. Whether you need help with specific subjects or study techniques, I'm ready to assist. How can I help you succeed?`,
                `Welcome ${userName}! As your AI tutor, I can help you understand complex concepts, organize your study materials, track your daily progress toward your 4-hour goals, and keep you motivated. What academic challenge would you like to tackle together?`,
                `Excellent, ${userName}! I'm designed to be your comprehensive academic companion. I can explain difficult topics, help with homework, manage your study schedule, and track your learning progress. What subject or study goal would you like to focus on?`
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                speechSynthesis.speak(utterance);
            }
        }

        // Utility Functions
        function showNotification(title, message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--bg-card);
                color: var(--text-primary);
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: var(--shadow-primary);
                z-index: 10000;
                border: 1px solid var(--border-color);
                max-width: 350px;
                animation: slideIn 0.3s ease;
            `;
            
            notification.innerHTML = `
                <div style="font-weight: 700; margin-bottom: 4px;">${title}</div>
                <div style="font-size: 14px; color: var(--text-secondary);">${message}</div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        // Auto-save progress every 5 minutes
        setInterval(saveUserData, 5 * 60 * 1000);

        console.log('🎓 Academic Hub Complete - Subject-based learning with progress tracking!');
    </script>
</body>
</html>
